---
title: "Chemometric Analysis for Food Fraud Detection"
subtitle: "FBMFOR — MSc Food Technology and Quality Assurance"
author: "Department of Food and Nutritional Sciences, University of Reading"
date: last-modified
---

```{=html}
<div class="colab-banner">
  <a href="https://colab.research.google.com/github/ggkuhnle/fbmfor-chemometrics/blob/main/notebooks/fbmfor_chemometrics_analysis.ipynb" target="_blank" class="colab-button">
    <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" height="28">
    &nbsp; Launch the Notebook in Google Colab
  </a>
</div>
<div>
<a href="https://mybinder.org/v2/gh/ggkuhnle/fbmfor-chemometrics/main?filepath=notebooks/fbmfor_chemometrics_analysis.ipynb.ipynb" target="_blank">
  <img src="https://mybinder.org/badge_logo.svg" alt="Open in Binder (no login required)">
</a>
</div>
```

## About This Notebook

This interactive notebook provides a complete chemometric analysis pipeline for spectroscopic data used in food fraud detection. It is designed for postgraduate students on the FBMFOR module to analyse NMR and FTIR data from their laboratory practicals.

The notebook runs entirely in **Google Colab** — no installation required. Simply click the badge above.

## What You Can Do

### Unsupervised Methods

**Principal Component Analysis (PCA)**
: Explore the natural structure of your spectral data. PCA reveals groupings, outliers, and the spectral regions driving variation — all without using class labels. The notebook provides interactive scores plots with 95% confidence ellipses, loadings plots, scree plots, and Hotelling's T² outlier detection.

**Hierarchical Cluster Analysis (HCA)**
: Visualise sample similarity as a dendrogram. Choose from different distance metrics and linkage methods to assess how well your samples cluster by class.

### Supervised Methods

**PLS-DA (Partial Least Squares Discriminant Analysis)**
: Classify samples using their spectral fingerprints. The notebook automatically optimises the number of latent variables via cross-validation and reports confusion matrices, classification accuracy, and VIP scores to identify the most discriminating spectral regions.

**OPLS-DA (Orthogonal PLS-DA)**
: Separate predictive variation from orthogonal (irrelevant) variation for cleaner class separation. Includes S-plots for biomarker identification and permutation testing for model validation.

### Preprocessing

All standard spectral preprocessing methods are available with adjustable parameters:

| Method | Purpose | Typical Use |
|--------|---------|-------------|
| ALS baseline correction | Remove baseline drift | FTIR |
| SNV normalisation | Remove scatter effects | FTIR, NIR |
| Area normalisation | Equalise total intensity | NMR |
| Min-max scaling | Scale to [0, 1] | General |
| Savitzky-Golay derivatives | Resolve overlapping peaks, remove baseline | FTIR, NIR |

## Data Format

The notebook accepts **CSV files** with a simple structure:

**Spectral data** — one row per sample, one column per spectral variable (wavenumber or chemical shift). The first column must be `Sample_ID`.

**Metadata** — a lookup table mapping `Sample_ID` to `Class` labels (e.g., "EVOO", "Adulterated").

A **demo dataset** (simulated olive oil FTIR with three classes: EVOO, Refined, Adulterated) is built into the notebook so you can explore the full pipeline immediately.

## How to Use

1. **Open the notebook** by clicking the Colab badge at the top of this page
2. **Run Section 1** (Setup) to load all required libraries
3. **Run Section 2** (Demo Dataset) to generate the example data, *or* go to Section 3 to upload your own CSV files
4. **Work through each section** sequentially — modify the clearly labelled parameter blocks (e.g., `NORMALISATION = "snv"`, `PC_X = 1`) and re-run the cell to see the effect
5. **Export results** (Section 10) to download PCA scores, loadings, and VIP scores as CSV files for your report

## Tips for Your Report

- **Always show preprocessing** — include before/after spectra plots and justify your choices
- **PCA is exploratory** — report the explained variance and describe what you see in the scores plot, but remember it does not use class information
- **Cross-validate supervised models** — never report calibration accuracy alone; always use the cross-validated results
- **VIP scores and S-plots** — use these to link your statistical results back to specific chemical features (e.g., particular absorption bands)
- **Permutation testing** — a p-value < 0.05 confirms your OPLS-DA model is detecting genuine class differences, not overfitting

## References

- Jolliffe, I.T. (2002). *Principal Component Analysis*, 2nd ed. Springer.
- Barker, M. & Rayens, W. (2003). Partial least squares for discrimination. *J. Chemometrics*, 17(3), 166–173.
- Trygg, J. & Wold, S. (2002). Orthogonal projections to latent structures (O-PLS). *J. Chemometrics*, 16(3), 119–128.
- Wiklund, S. et al. (2008). Visualization of GC/TOF-MS-based metabolomics data using OPLS class models. *Anal. Chem.*, 80(1), 115–122.
- Eilers, P.H.C. & Boelens, H.F.M. (2005). Baseline correction with asymmetric least squares smoothing.
- Barnes, R.J., Dhanoa, M.S. & Lister, S.J. (1989). Standard normal variate transformation. *Appl. Spectrosc.*, 43(5), 772–777.

## Contact

For questions about this notebook or the FBMFOR module:

**Gunter Kuhnle** — g.g.kuhnle@reading.ac.uk
Department of Food and Nutritional Sciences, University of Reading
